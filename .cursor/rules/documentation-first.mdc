---
description: Always consult project documentation structure before starting work
alwaysApply: true
---

# Documentation-First Development

Always consult the project documentation structure before starting any development work. The documentation is the single source of truth for architecture, features, and plans.

## Documentation Entry Point

**Always start with `CLAUDE.md` in the project root**, which redirects to `docs/overview.md` - the main documentation hub.

## Required Documentation Consultation

Before starting any task, consult these documentation files:

1. **`docs/overview.md`** - Main documentation index (start here)
2. **`docs/ai/README.md`** - AI development guide with patterns and recipes
3. **`docs/architecture.md`** - Architecture Decision Records (ADRs) with key file references
4. **`docs/features.md`** - Existing features and capabilities
5. **`docs/roadmaps.md`** - Development roadmaps and plans

### AI Guide Consultation

**For implementation work, always check the AI guide:**
- **`docs/ai/context-loading.md`** - Which files to read for your task type
- **`docs/ai/patterns.md`** - Code patterns to follow
- **`docs/ai/anti-patterns.md`** - Common mistakes to avoid
- **`docs/ai/recipes/`** - Step-by-step guides for common tasks

### Architecture Consultation

- **Always check `docs/architecture.md`** to understand:
  - Which ADRs apply to your task
  - Key implementation files for relevant ADRs
  - Architectural patterns and decisions that must be followed

- **Use ADR file references** to quickly navigate to relevant code:
  - Each ADR lists key files that implement the decision
  - Follow existing patterns found in those files

### Roadmap Consultation

- **Always check `docs/roadmaps.md`** before planning new work:
  - Verify if the feature/task is already planned
  - Understand how your work fits into existing plans
  - Check for related work in journal entries
  - Identify dependencies or prerequisites

- **If your task is on the roadmap:**
  - Review the roadmap details and priorities
  - Follow the planned approach if specified
  - Update roadmap status as you complete work

- **If your task is NOT on the roadmap:**
  - Consider if it should be added
  - Check if it conflicts with planned work
  - Document your approach for future reference

## Planning Phase Requirements

**When creating a plan, you MUST consult patterns and recipes:**

1. **Check `docs/ai/context-loading.md`** - Identify which files and recipes apply to your task type
2. **Check `docs/ai/recipes/`** - Find applicable step-by-step guides
3. **Check `docs/ai/patterns.md`** - Identify code patterns to follow

**Plans must include:**
- Names of applicable recipes that will guide implementation
- References to relevant patterns for code style
- Links to ADRs that govern the feature area

## Documentation Updates in Plans

**All plans must include documentation updates** as part of the work:

1. **Update relevant section files** (`docs/features.md`, `docs/architecture.md`, etc.) if:
   - Adding new features
   - Changing architecture
   - Modifying configuration

2. **Update ADR file references** in `docs/architecture.md` if:
   - Creating new implementation files
   - Refactoring existing architecture
   - Adding new ADRs

3. **Update roadmaps** in `docs/roadmaps.md` if:
   - Completing planned work
   - Adding new planned work
   - Changing priorities or approaches

4. **ALWAYS add links to `docs/roadmaps.md`** when creating new roadmap files:
   - Every new `docs/plans/*.md` file MUST have a corresponding link in `docs/roadmaps.md`
   - Add to appropriate section (Active Development or Planned Features)
   - Include brief description after the link

5. **Update AI development guide** (`docs/ai/`) if:
   - Adding new code patterns or changing existing ones → update `patterns.md`
   - Creating new feature areas or key files → update `context-loading.md`
   - Discovering common mistakes or gotchas → update `anti-patterns.md` or `README.md` gotchas
   - Adding common repeatable tasks → consider adding a recipe in `recipes/`

6. **Create journal entries** in `docs/journal/` for:
   - Significant changes (see journaling-documentation.mdc)
   - Architecture decisions
   - Major refactoring

## Before Finishing Work

- Before finishing work, run a code review using the [Code Review recipe](docs/ai/recipes/code-review.md) (or the quick checks in the code-review rule).

## Documentation Structure

The documentation is organized into focused files:

- `docs/overview.md` - Main index
- `docs/ai/` - **AI development guide** (patterns, anti-patterns, recipes, context loading)
- `docs/features.md` - Feature documentation
- `docs/architecture.md` - ADRs with file references
- `docs/development.md` - Development setup and config
- `docs/docker.md` - Docker configuration
- `docs/roadmaps.md` - Plans and journal entries
- `docs/api-reference.md` - API documentation
- `docs/user-docs.md` - User guides
- `docs/quick-reference.md` - Quick lookup

**Keep files minimal and focused** - each file should be small and easy to navigate.

## Workflow

1. **Start**: Read `CLAUDE.md` → `docs/overview.md`
2. **Load Context**: Check `docs/ai/context-loading.md` for files to read
3. **Understand**: Check `docs/architecture.md` for relevant ADRs
4. **Plan**: Review `docs/roadmaps.md`, identify applicable recipes from `docs/ai/recipes/`, reference patterns from `docs/ai/patterns.md`
5. **Work**: Follow the identified patterns and recipes
6. **Document**: Update relevant documentation files as part of the work
7. **Journal**: Create journal entry for significant changes
